/*! Ideal Postcodes jQuery Plugin - v3.0.6 - 2017-11-17
* https://github.com/ideal-postcodes/jquery.postcodes
2017 Ideal Postcodes; Licensed MIT */

!function(e){"use strict";function o(o){this.config={},e.extend(this,r),o&&e.extend(this,o);var t={};for(var s in this.output_fields)void 0!==this.output_fields[s]&&(t[s]=e(this.output_fields[s]));this.$output_fields=t}var t=[],s={},r={api_key:"",output_fields:{line_1:"#line_1",line_2:"#line_2",line_3:"#line_3",post_town:"#post_town",postcode:"#postcode",postcode_inward:void 0,postcode_outward:void 0,udprn:void 0,dependant_locality:void 0,double_dependant_locality:void 0,thoroughfare:void 0,dependant_thoroughfare:void 0,building_number:void 0,building_name:void 0,sub_building_name:void 0,po_box:void 0,department_name:void 0,organisation_name:void 0,postcode_type:void 0,su_organisation_indicator:void 0,delivery_point_suffix:void 0},endpoint:"https://api.ideal-postcodes.co.uk/v1",input:void 0,$input:void 0,input_label:"Please enter your postcode",placeholder_label:"",input_muted_style:"color:#CBCBCB;",input_class:"",input_id:"idpc_input",button:void 0,$button:void 0,button_id:"idpc_button",button_label:"Find my Address",button_class:"",button_disabled_message:"Looking up postcode...",$dropdown:void 0,dropdown_id:"idpc_dropdown",dropdown_select_message:"Please select your address",dropdown_class:"",dropdown_container:void 0,$error_message:void 0,error_message_id:"idpc_error_message",error_message_invalid_postcode:"Please check your postcode, it seems to be incorrect",error_message_not_found:"Your postcode could not be found. Please type in your address",error_message_address_not_found:"We could not find a match for your address. Please type in your address",error_message_default:"Sorry, we weren't able to get the address you were looking for. Please type your address manually",error_message_class:"",error_message_container:void 0,address_search:!1,last_lookup:"",disable_interval:1e3,debug_mode:!1,check_key:!1,remove_organisation:!1,licensee:null,address_formatters:{postcode_search:function(e){var o=[e.line_1];return""!==e.line_2&&o.push(e.line_2),o.join(" ")},address_search:function(e){var o=[e.line_1];return""!==e.line_2&&o.push(e.line_2),o.push(e.post_town),o.push(e.postcode_outward),o.join(", ")}},onLoaded:void 0,onFailedCheck:void 0,onSearchCompleted:void 0,onAddressesRetrieved:void 0,onAddressSelected:void 0,onDropdownCreated:void 0,onDropdownDestroyed:void 0,onLookupTriggered:void 0,shouldLookupTrigger:void 0,onSearchError:void 0,tags:void 0},n=function(e){return 0!==e.organisation_name.length&&e.line_1===e.organisation_name&&(e.line_1=e.line_2,e.line_2=e.line_3,e.line_3=""),e};o.prototype.setupPostcodeInput=function(e){this.$context=e,this.setupInputField(),this.setupLookupButton()},o.prototype.setupInputField=function(){var o=this;return e(this.input).length?this.$input=e(this.input).first():this.$input=e("<input />",{type:"text",id:this.input_id,value:this.input_label,placeholder:this.placeholder_label}).appendTo(this.$context).addClass(this.input_class).val(this.input_label).attr("style",this.input_muted_style).submit(function(){return!1}).keypress(function(e){13===e.which&&o.$button.trigger("click")}).focus(function(){o.$input.removeAttr("style").val("")}).blur(function(){o.$input.val()||(o.$input.val(o.input_label),o.$input.attr("style",o.input_muted_style))}),this.$input},o.prototype.setupLookupButton=function(){var o=this;return e(o.button).length?o.$button=e(o.button).first():o.$button=e("<button />",{html:o.button_label,id:o.button_id,type:"button"}).appendTo(o.$context).addClass(o.button_class).attr("onclick","return false;").submit(function(){return!1}),o.$button.click(function(){o.onLookupTriggered&&o.onLookupTriggered.call(o);var e=function(){var e=o.$input.val();o.last_lookup!==e&&(o.last_lookup=e,o.clearAll(),o.disableLookup(),o.executeSearch(e))};return o.shouldLookupTrigger?o.shouldLookupTrigger.call(o,e):e(),!1}),o.$button},o.prototype.disableLookup=function(e){this.button||(e=e||this.button_disabled_message,this.$button.prop("disabled",!0).html(e))},o.prototype.enableLookup=function(){if(!this.button){var e=this;0===e.disable_interval?e.$button.prop("disabled",!1).html(e.button_label):setTimeout(function(){e.$button.prop("disabled",!1).html(e.button_label)},e.disable_interval)}},o.prototype.clearAll=function(){this.setDropDown(),this.setErrorMessage()},o.prototype.removeAll=function(){this.$context=null,e.each([this.$input,this.$button,this.$dropdown,this.$error_message],function(e,o){o&&o.remove()})},o.prototype.executeSearch=function(e){var o,t=this,s=function(s,r,n){t.enableLookup(),t.cacheSearchResults(n),s?(o=t.debug_mode?s.message:t.error_message_default,t.setErrorMessage(o),t.onSearchError&&t.onSearchError.call(t,s)):r.length>0?(t.last_lookup=e,t.onAddressesRetrieved&&t.onAddressesRetrieved.call(t,r),t.setDropDown(r)):(o=t.address_search?t.error_message_address_not_found:t.error_message_not_found,t.setErrorMessage(o)),t.onSearchCompleted&&t.onSearchCompleted.call(t,n)};return t.address_search?t.executeAddressSearch(e,s):t.executePostcodeSearch(e,s)},o.prototype.executePostcodeSearch=function(o,t){var s=this,r={query:o,api_key:s.api_key};s.tags&&(r.tags=s.tags),s.licensee&&(r.licensee=s.licensee),e.idealPostcodes.lookupPostcode(r,t)},o.prototype.executeAddressSearch=function(o,t){var s=this,r={query:o,api_key:s.api_key};"object"==typeof s.address_search&&(r.limit=s.address_search.limit||10),s.tags&&(r.tags=s.tags),s.licensee&&(r.licensee=s.licensee),e.idealPostcodes.lookupAddress(r,t)},o.prototype.cacheSearchResults=function(e){return null===e?null:(this.response_code=e.code,this.response_message=e.message,this.result=e.result,e)},o.prototype.setDropDown=function(o){var t=this,s=t.address_formatters.postcode_search;if(t.address_search&&(s=t.address_formatters.address_search),this.$dropdown&&this.$dropdown.length&&(this.$dropdown.remove(),delete this.$dropdown,this.onDropdownDestroyed&&this.onDropdownDestroyed.call(this)),o){var r=e("<select />",{id:t.dropdown_id}).addClass(t.dropdown_class);e("<option />",{value:"ideal",text:t.dropdown_select_message}).appendTo(r);for(var i=o.length,a=0;a<i;a+=1)e("<option />",{value:a,text:s(o[a])}).appendTo(r);var d;return d=e(this.dropdown_container).length?e(this.dropdown_container).first():this.$context,r.appendTo(d).change(function(){var s,r=e(this).val();r>=0&&(s=t.remove_organisation?n(o[r]):o[r],t.setAddressFields(s),t.onAddressSelected&&t.onAddressSelected.call(t,s))}),t.onDropdownCreated&&t.onDropdownCreated.call(t,r),t.$dropdown=r,r}},o.prototype.setErrorMessage=function(o){if(this.$error_message&&this.$error_message.length&&(this.$error_message.remove(),delete this.$error_message),o){var t;return t=e(this.error_message_container).length?e(this.error_message_container).first():this.$context,this.$error_message=e("<p />",{html:o,id:this.error_message_id}).addClass(this.error_message_class).appendTo(t),this.$error_message}},o.prototype.setAddressFields=function(e){e=e||{};for(var o in this.$output_fields)this.$output_fields[o].val(e[o]||"")};var i=function(e){return e.code+" - "+e.message};e.idealPostcodes={defaults:function(){return r},keyCheckCache:s,lookupPostcode:function(o,t){var s,n=o.query||o.postcode||"",a=o.api_key||"",d=[r.endpoint,"postcodes",encodeURI(n)].join("/"),l={api_key:a};s=o.error?o.error:function(e,o){return t(new Error("Request Failed: "+o),[],null,e)},o.tags&&e.isArray(o.tags)&&(l.tags=o.tags.join(",")),o.licensee&&(l.licensee=o.licensee);var u={url:d,data:l,dataType:"jsonp",timeout:1e4,success:function(e,o,s){return 2e3===e.code?t(null,e.result,e,s):4040===e.code?t(null,[],e,s):t(new Error(i(e)),[],e,s)},error:s};e.ajax(u)},lookupAddress:function(o,t){var s,n=o.query||"",a=o.api_key||"",d=[r.endpoint,"addresses"].join("/"),l={api_key:a,query:n};s=o.error?o.error:function(e,o){return t(new Error("Request Failed: "+o),[],null,e)},l.limit=o.limit||10,o.tags&&e.isArray(o.tags)&&(l.tags=o.tags.join(",")),o.licensee&&(l.licensee=o.licensee);var u={url:d,data:l,dataType:"jsonp",timeout:1e4,success:function(e,o,s){return 2e3===e.code?t(null,e.result.hits,e,s):t(new Error(i(e)),[],e,s)},error:s};e.ajax(u)},checkKey:function(o,t,n){var i=o.api_key||"";n=n||function(){};var a=s[i];if("boolean"==typeof a)return a?t():n();if("object"==typeof a)return s[i].success.push(t),void s[i].error.push(n);s[i]={success:[t],error:[n]};var d={url:[r.endpoint,"keys",i].join("/"),dataType:"jsonp",timeout:1e4};o.licensee&&(d.data={licensee:o.licensee}),d.success=function(o){if(o&&o.result&&o.result.available){var t=s[i].success;s[i]=!0,e.each(t,function(e,t){t.call(null,o)})}else{var r=s[i].error;s[i]=!1,e.each(r,function(e,o){o.call()})}},d.error=function(){var o=s[i].error;delete s[i],e.each(o,function(e,o){o.call()})},e.ajax(d)},clearAll:function(){for(var e=t.length,o=0;o<e;o+=1)t[o].removeAll()}},e.fn.setupPostcodeLookup=function(s){var r=this;if(0===r.length)return r;var n=function(){e.each(r,function(r,n){var i=new o(s);t.push(i),i.setupPostcodeInput(e(n))}),e.isFunction(s.onLoaded)&&s.onLoaded.call(r)};if(s.check_key){var i={api_key:s.api_key};s.licensee&&(i.licensee=s.licensee),e.idealPostcodes.checkKey(i,n,function(){e.isFunction(s.onFailedCheck)&&s.onFailedCheck.call(r)})}else n();return r}}(jQuery);